const GET_MSG       = 'http://feedback.local/get-comment';
const POST_MSG      = 'http://feedback.local/post-comment';

class CommentSystem {
    /**
     * description
     * buttonId {string} form button selector
     * commentListId {string} comment list (ul) selector
     * geturl {string}
     * postUrl {string}
     */ 
    constructor(buttonId, commentListId, getUrl, postUrl) {
        this.form =  document.querySelector(buttonId);
        this.lastComment;
        this.get = getUrl;
        this.post= postUrl;
    }
        
    csGetMsgPool(msgListLenght) {
        csGetMessage(this.post)
    }

    csPrepareData() {
        return new FormData(this.form);
    }

    csPostComment() {
        return fetch(this.post, {
            method: 'POST',
            body: this.csPrepareData(),
        })
        .then(responce => {
            if (responce.ok) 
                responce => responce.json();
        })
        .then(responce => {
            this.csGetMessage();
        })
        .catch(err => {
            console.log("Post message error: " + err);
        });

    }

    csGetMessage(numof) {
        
        let get = numof ? this.get + '?' + numof : this.get;

        fetch(get)
            .then( responce => {
                if (responce.ok) {
                    responce.json().then(json=>{
                        return json;
                    });
                }
            })
            .catch(err=> {
                console.log("Getting Message error: " + err);
            });
    }

    csCommentListManager() {
        
    }
}

const cs = new CommentSystem("#send_comment", );
cs  .form
    .querySelector("#send_comment")
    .addEventListener('click', ()=>{
        (r = cs.csPostComment())
            .then(()=>{console.log(r)});
    });
